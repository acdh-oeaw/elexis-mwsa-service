# Swagger generated server

## Overview
This server was generated by the [swagger-codegen](https://github.com/swagger-api/swagger-codegen) project. By using the
[OpenAPI-Spec](https://github.com/swagger-api/swagger-core/wiki) from a remote server, you can easily generate a server stub.  This
is an example of building a swagger-enabled Flask server.

This example uses the [Connexion](https://github.com/zalando/connexion) library on top of Flask.

## Requirements
Python 3.7

## Recommended Usage (Docker)
1. To run the server, please execute the following from the root directory:
```
pip3 install -r requirements.txt
dvc pull
```
dvc pull command downloads all models into ‘models’ directory within the git repository

2. (Optionally) Copy the models from ‘models’ directory to the directory where you want to serve the models

3. Pull Docker Image
   
```
Docker pull acdhch/elexis_mwsa_service
```
4. Run docker container: replace curly brance part with your model path.
   Assign enough resources on docker desktop, since the service loads large models into memory(Tested with 15GB memory assigned).
```
docker run -p 5000:5000 -v {MODEL_PATH_HOST}:/mwsa --env MODEL_PATH=/mwsa acdhch/elexis_mwsa_service	
```

5. Test local service with:
```
   curl --location --request POST 'http://localhost:5000/ACDH/ACDH_MWSA_Service/1o/achda-mwsa/scores/' --header 'Content-Type: application/json' --data-raw '{
   "classifier": "randomforst",
   "pair": {
   "headword": "olive",
   "pos": "noun",
   "lang": "en",
   "def1": "a type of edible fruit",
   "def2": "a type of edible fruit which is used as a garnish etc and which gives oil used for cooking"
   }
   }'
```

# Unit/Integration Tests

To launch the integration tests, use tox:
```
sudo pip install tox
tox
```
